<!DOCTYPE html>
<html>

<head>
    <title>
        Convert Image to Grayscale
    </title>
</head>

<body>

    <script src="SimpleImage.js">
    </script>

    <h1>Convert Image to Grayscale</h1>

    <canvas id="can">
    </canvas>
    <canvas id="gray">
    </canvas>


    <p>
        <input type="file" multiple="false" accept="image/*" id="finput" onchange="upload()">
    </p>
    <p>
        <input type="button" value="Make Grayscale" onclick="makeGray()">
    </p>
</body>

</html>

<style>
    h1 {
        font-family: arial;
        color: dimgray;
    }

    body {
        font-family: arial;
        margin: 30px;
    }

    #gray {
        height: 200px;
        border: 1px solid lightgray;
        align-items: baseline;
    }
    #can {
        height: 200px;
        border: 1px solid lightgray;
    }
</style>

<script>
    var image = null;
    function upload() {
        //Get input from file input
        var fileinput = document.getElementById("finput");
        //Make new SimpleImage from file input
        image = new SimpleImage(fileinput);
        //Get canvas
        var canvas = document.getElementById("can");
        //Draw image on canvas
        image.drawTo(canvas);
        var canvas1 = document.getElementById("gray");
        //Draw image on canvas
        image.drawTo(canvas1);
    }
    function makeGray() {
        for (var pixel of image.values()) {
            var avg = (pixel.getRed() + pixel.getGreen() + pixel.getBlue()) / 3;
            pixel.setRed(avg);
            pixel.setGreen(avg);
            pixel.setBlue(avg);
        }
        var imgcanvas = document.getElementById("gray");
        //Draw image on canvas
        image.drawTo(imgcanvas);
    }


</script>